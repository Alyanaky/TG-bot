import logging
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, CallbackQueryHandler, MessageHandler, filters, ContextTypes

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO)

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞
TOKEN = '7376905443:AAGF5Qy4aUpPvkCtEyFRKwgWesHx2Wv3m0A'

# –§–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤
PHONE_NUMBERS_FILE = 'phone_numbers.txt'

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–æ–º–µ—Ä–∞ –≤ —Ñ–∞–π–ª
def save_phone_number(phone_number: str):
    with open(PHONE_NUMBERS_FILE, 'a') as file:
        file.write(f"{phone_number}\n")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = [
        [InlineKeyboardButton("–ò–Ω—Ç–µ—Ä–Ω–µ—Ç, –¢–í –∏ –ú–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å", callback_data='internet_tv_mobile')],
        [InlineKeyboardButton("–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", callback_data='video_surveillance')]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text(
        "üëã –ü—Ä–∏–≤–µ—Ç, —è –±–æ—Ç! –ß—Ç–æ —É–º–µ–µ—Ç —ç—Ç–æ—Ç –±–æ—Ç?\n"
        "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å ‚¨áÔ∏è\n"
        "–ü–æ–¥–∫–ª—é—á–∞–π –ò–Ω—Ç–µ—Ä–Ω–µ—Ç + –¢–í + –ú–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å –æ—Ç –ú–¢–°. KION –≤ –ø–æ–¥–∞—Ä–æ–∫!\n"
        "üìå –ë—ã—Å—Ç—Ä–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.\n"
        "üìå –°—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.\n"
        "üìå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º.\n"
        "üìå –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚¨áÔ∏è",
        reply_markup=reply_markup
    )

# –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫
async def button(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()

    # –£–±–∏—Ä–∞–µ–º –æ—Ç–≤–µ—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞ –∏ –¥–µ–ª–∞–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    if query.data == 'internet_tv_mobile':
        await query.message.reply_text("üì° –¢–∞—Ä–∏—Ñ ‚Ññ1\n"
                                        "–ü—Ä–æ—Å—Ç–æ 3 –≤ 1: –º–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –¢–í\n"
                                        "–í–∫–ª—é—á–µ–Ω–æ –≤ —Ç–∞—Ä–∏—Ñ:")
        await query.message.reply_text("üì∂ –ú–æ–±–∏–ª—å–Ω—ã–π –∏ –¥–æ–º–∞—à–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±—Ä–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø–ª–∞—Ç—É\n"
                                        "üçø –û–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä KION –¥–æ 5 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ\n"
                                        "üì∫ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ KION\n"
                                        "üì± –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã (WhatsApp, Telegram, Viber, Discord, Skype, ICQ, –ú–¢–° Connect, Snapchat, –¢–∞–º-–¢–∞–º)\n"
                                        "üåê –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ—Ü —Å–µ—Ç–∏ (–í–ö–æ–Ω—Ç–∞–∫—Ç–µ, –û–¥–Ω–æ–∫–ª–∞—Å–Ω–∏–∫–∏)\n"
                                        "üìà –ú–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç 30 –ì–±\n"
                                        "‚òéÔ∏è –ó–≤–æ–Ω–∫–∏ 800 –º–∏–Ω—É—Ç –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏\n"
                                        "‚úâÔ∏è 100 SMS\n"
                                        "üì∫ IPTV –±–æ–ª–µ–µ 200 –∫–∞–Ω–∞–ª–æ–≤\n"
                                        "üõ°Ô∏è –°—Ç—Ä–∞—Ö–æ–≤–æ–π –ø–æ–ª–∏—Å –Ω–∞ —Å–ª—É—á–∞–π –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è —á—É–∂–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å –≤–æ–∑–º–µ—â–µ–Ω–∏–µ–º –¥–æ 100 000 —Ä—É–±–ª–µ–π\n"
                                        "üí∞ –¶–µ–Ω–∞ –ø–æ –∞–∫—Ü–∏–∏ 425—Ä/–º–µ—Å –±–∞–∑–æ–≤–∞—è 850—Ä")
        await query.message.reply_text("‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:\n"
                                        "‚ö°Ô∏è –û–ø—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç—å 200 –ú–±–∏—Ç/—Å–µ–∫ - 50 —Ä—É–±/–º–µ—Å\n"
                                        "‚ö°Ô∏è 500 –ú–±–∏—Ç/—Å–µ–∫ - 100 —Ä—É–±/–º–µ—Å\n"
                                        "‚ö°Ô∏è 1 –ì–±–∏—Ç/—Å–µ–∫ - 250 —Ä—É–±/–º–µ—Å\n"
                                        "üë™ –ì—Ä—É–ø–ø–∞ –¥–ª—è –±–ª–∏–∑–∫–∏—Ö\n"
                                        "üìû –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ —Å –¥—Ä—É–≥–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ø–æ–ª–≥–æ–¥–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ\n"
                                        "‚ûï +1 –Ω–æ–º–µ—Ä 300—Ä/–º–µ—Å\n"
                                        "üìä 25 –ì–± 500 –º–∏–Ω—É—Ç 100 SMS")
        await query.message.reply_text("üìû –ï—Å–ª–∏ –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.")
        
    elif query.data == 'video_surveillance':
        await query.message.reply_text("üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞...\n"
                                                                               "üé• –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è 24/7\n"
                                        "üö® –ó–∞–ø–∏—Å—å –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏\n"
                                        "üìÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π 7 –∏–ª–∏ 14 –¥–Ω–µ–π\n"
                                        "üó£Ô∏è –î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –≥–æ–ª–æ—Å–æ–≤–∞—è —Å–≤—è–∑—å\n"
                                        "üîç Full HD –∫–∞–º–µ—Ä–∞ —Å –Ω–æ—á–Ω—ã–º —Ä–µ–∂–∏–º–æ–º")
        await query.message.reply_text("1 –∫–∞–º–µ—Ä–∞:\n"
                                        "üíµ 290—Ä/–º–µ—Å –∞—Ä—Ö–∏–≤ 7 –¥–Ω–µ–π\n"
                                        "üíµ 390—Ä/–º–µ—Å 14 –¥–Ω–µ–π\n")
        await query.message.reply_text("üìû –ï—Å–ª–∏ –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_phone = update.message.text
    save_phone_number(user_phone)
    await update.message.reply_text(f"üìû –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ {user_phone} –±—ã–ª –ø–æ–ª—É—á–µ–Ω. –°–ø–∞—Å–∏–±–æ!")

def main():
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–∞–µ–º –µ–º—É –≤–∞—à —Ç–æ–∫–µ–Ω
    application = ApplicationBuilder().token(TOKEN).build()

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
    application.add_handler(CommandHandler("start", start))

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫
    application.add_handler(CallbackQueryHandler(button))

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    application.run_polling()

if __name__ == '__main__':
    main()
